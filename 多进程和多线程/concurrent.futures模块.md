# Qï¼šconcurrent.futuresæ˜¯ä»€ä¹ˆ
`concurrent.futures` æ˜¯ Python æ ‡å‡†åº“ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œç”¨äºç®€åŒ–å¹¶å‘ç¼–ç¨‹ã€‚å®ƒæä¾›äº†é«˜çº§æ¥å£ï¼Œç”¨äºå¼‚æ­¥æ‰§è¡Œå¯è°ƒç”¨å¯¹è±¡ï¼ˆå¦‚å‡½æ•°ï¼‰ï¼Œæ”¯æŒ **å¤šçº¿ç¨‹** å’Œ **å¤šè¿›ç¨‹** ä¸¤ç§å¹¶å‘æ¨¡å‹ã€‚

è¿™ä¸ªæ¨¡å—ä¸»è¦æä¾›ä¸¤ä¸ªæ‰§è¡Œå™¨ï¼ˆExecutorï¼‰ç±»ï¼š

1. **`ThreadPoolExecutor`**ï¼šåŸºäºçº¿ç¨‹æ± ï¼Œé€‚åˆ I/O å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚æ–‡ä»¶æ“ä½œã€ç½‘ç»œè¯·æ±‚ï¼‰ã€‚
    
2. **`ProcessPoolExecutor`**ï¼šåŸºäºè¿›ç¨‹æ± ï¼Œé€‚åˆ CPU å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚å¤æ‚çš„è®¡ç®—ã€æ•°æ®å¤„ç†ï¼‰ã€‚
    

---

### ä½¿ç”¨ç¤ºä¾‹

#### 1. ä½¿ç”¨ `ThreadPoolExecutor`

```python
from concurrent.futures import ThreadPoolExecutor

def task(n):
    return n * n

with ThreadPoolExecutor(max_workers=4) as executor:
    futures = [executor.submit(task, i) for i in range(10)]
    results = [f.result() for f in futures]
    print(results)
```

#### 2. ä½¿ç”¨ `ProcessPoolExecutor`

```python
from concurrent.futures import ProcessPoolExecutor

def task(n):
    return n * n

with ProcessPoolExecutor(max_workers=4) as executor:
    results = list(executor.map(task, range(10)))
    print(results)
```

---

### å¸¸ç”¨æ–¹æ³•å’Œæ¦‚å¿µ

- **`submit(fn, *args, **kwargs)`**ï¼šæäº¤ä¸€ä¸ªä»»åŠ¡ï¼Œè¿”å›ä¸€ä¸ª `Future` å¯¹è±¡ã€‚
    
- **`map(fn, iterable)`**ï¼šç±»ä¼¼å†…ç½®çš„ `map`ï¼Œå¹¶å‘æ‰§è¡Œã€‚
    
- **`Future.result()`**ï¼šé˜»å¡ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆå¹¶è¿”å›ç»“æœã€‚
    
- **`as_completed(futures)`**ï¼šæŒ‰ä»»åŠ¡å®Œæˆçš„é¡ºåºè¿”å› `Future` å¯¹è±¡ã€‚
    
- **`wait(futures)`**ï¼šç­‰å¾…ä¸€ç»„ä»»åŠ¡å®Œæˆã€‚
    

---

### ä¼˜ç‚¹

- ç®€æ´ï¼šæ¯”ä½çº§æ¨¡å—ï¼ˆå¦‚ `threading`ã€`multiprocessing`ï¼‰æ›´æ˜“ç”¨ã€‚
    
- çµæ´»ï¼šæ ¹æ®ä»»åŠ¡ç±»å‹é€‰æ‹©çº¿ç¨‹æˆ–è¿›ç¨‹æ± ã€‚
    
- å®‰å…¨ï¼šä¸Šä¸‹æ–‡ç®¡ç†å™¨è‡ªåŠ¨æ¸…ç†èµ„æºã€‚
    

å¦‚æœä½ å‘Šè¯‰æˆ‘ä½ çš„å…·ä½“åœºæ™¯ï¼ˆæ¯”å¦‚ä½ æ˜¯åšç½‘ç»œçˆ¬è™«ï¼Œè¿˜æ˜¯å›¾åƒå¤„ç†ï¼‰ï¼Œæˆ‘å¯ä»¥ç»™å‡ºæ›´é’ˆå¯¹æ€§çš„ç”¨æ³•å»ºè®®ã€‚
# Qï¼šå®ƒæ˜¯å¯¹threadingã€multiprocessingçš„ä¸€ä¸ªå°è£…å—
æ˜¯çš„ï¼Œ**`concurrent.futures` å¯ä»¥çœ‹ä½œæ˜¯å¯¹ `threading` å’Œ `multiprocessing` æ¨¡å—çš„ä¸€ä¸ªé«˜çº§å°è£…**ï¼Œç›®çš„æ˜¯è®©å¹¶å‘ç¼–ç¨‹æ›´ç®€å•ã€æ›´ç»Ÿä¸€ã€æ›´æ˜“ç”¨ã€‚

---

### å®ƒæ˜¯å¦‚ä½•å°è£…çš„ï¼Ÿ

|`concurrent.futures` ç±»|å†…éƒ¨åº•å±‚å®ç°|ç”¨é€”|
|---|---|---|
|`ThreadPoolExecutor`|ä½¿ç”¨ `threading` æ¨¡å—|I/O å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚ç½‘ç»œã€ç£ç›˜ï¼‰|
|`ProcessPoolExecutor`|ä½¿ç”¨ `multiprocessing` æ¨¡å—|CPU å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚è®¡ç®—ã€å¤§æ•°æ®å¤„ç†ï¼‰|

---

### å¯¹æ¯”ï¼š

|ç‰¹æ€§|`threading` / `multiprocessing`|`concurrent.futures`|
|---|---|---|
|ç¼–ç¨‹å¤æ‚åº¦|é«˜ï¼šéœ€è¦æ‰‹åŠ¨ç®¡ç†çº¿ç¨‹/è¿›ç¨‹ã€é˜Ÿåˆ—ç­‰|ä½ï¼šæä¾›ç»Ÿä¸€ã€é«˜çº§æ¥å£|
|ä»»åŠ¡ç®¡ç†|æ‰‹åŠ¨æ§åˆ¶ã€é€šä¿¡ã€åŒæ­¥ç­‰å¤æ‚ç»†èŠ‚|è‡ªåŠ¨ç®¡ç†ï¼Œä½¿ç”¨ `Future` å¯¹è±¡è·å–ç»“æœ|
|æ¥å£ç»Ÿä¸€æ€§|å„è‡ªæ¨¡å—ä¸åŒæ¥å£|åŒä¸€ä¸ª API é£æ ¼|
|é”™è¯¯å¤„ç†å’Œè¶…æ—¶|éœ€è¦è‡ªå·±æ•è·å’Œå¤„ç†|å†…ç½®æ”¯æŒ `.result(timeout=...)` ç­‰|

---

### ä¸€ä¸ªç®€å•ç±»æ¯”ï¼š

å¦‚æœè¯´ `threading` å’Œ `multiprocessing` æ˜¯â€œåŸææ–™â€ï¼Œ  
é‚£ä¹ˆ `concurrent.futures` å°±æ˜¯â€œç°ä»£å¨æˆ¿ç”µå™¨â€â€”â€”æ›´å®‰å…¨ã€æ“ä½œæ›´ç®€å•ï¼Œè¿˜è‡ªå¸¦è¯´æ˜ä¹¦ ğŸ˜„

---

ä½ ä»ç„¶å¯ä»¥ä½¿ç”¨åº•å±‚æ¨¡å—æ¥å®ç°æ›´çµæ´»æˆ–é«˜çº§çš„æ§åˆ¶ï¼Œæ¯”å¦‚å…±äº«å†…å­˜ã€é”æœºåˆ¶ã€è‡ªå®šä¹‰é˜Ÿåˆ—ç­‰ã€‚ä½†å¤§å¤šæ•°æ—¥å¸¸å¹¶å‘ä»»åŠ¡ï¼Œç”¨ `concurrent.futures` å°±è¶³å¤Ÿäº†ã€‚

æ˜¯å¦éœ€è¦æˆ‘å¸®ä½ ç”¨å®ƒæ¥æ”¹å†™ä½ ç°æœ‰çš„å¤šçº¿ç¨‹æˆ–å¤šè¿›ç¨‹ä»£ç ï¼Ÿ